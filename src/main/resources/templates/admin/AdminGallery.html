<!DOCTYPE html>
<html lang="id" data-theme="light" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Edit Layanan</title>
    <link rel="stylesheet" th:href="@{/css/output.css}" />
</head>

<body class="font-sans bg-base-200 min-h-screen text-neutral">
    <div th:replace="fragment/navbar :: navbar"></div>

    <div class="flex flex-col lg:flex-row mt-16 min-h-screen bg-base-200">

        <div th:replace="fragment/navbar :: sidebar('gallery')"></div>


        <main class="h-full w-full lg:w-[calc(100%-4rem)] p-4 lg:p-8 mb-20">

            <div class="w-full flex justify-between p-4">
                <h1 class="text-2xl md:text-3xl font-bold mb-6">Gallery</h1>


                <button class="btn btn-success gap-2" id="addGalleryButton">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
                            clip-rule="evenodd" />
                    </svg>
                    tambah
                </button>

            </div>

            <!-- Masonry-style grid dengan gaya Path -->
            <div class="columns-2 sm:columns-3 lg:columns-4 xl:columns-5 gap-2 sm:gap-3">
                <!-- Loop thymeleaf -->
                <div th:each="image : ${images}" th:if="${image.galleryImage == true}"
                    class="relative break-inside-avoid overflow-hidden rounded-xl mb-2 sm:mb-3 group transition-all duration-300 hover:shadow-2xl hover:scale-[1.02]">
                    <!-- Gambar -->
                    <img th:src="@{'/uploads/' + ${image.imageFileName}}" alt="Gallery Image"
                        class="w-full object-cover rounded-xl transition-transform duration-300 group-hover:scale-105"
                        style="min-height: 150px; max-height: 400px;" />
                    <!-- Tombol delete selalu terlihat -->
                    <button
                        class="absolute top-2 right-2 bg-red-600/90 hover:bg-red-700 text-white rounded-full p-2 shadow-lg transition"
                        th:attr="data-id=${image.id}" title="Delete image">
                        <!-- SVG trash icon -->
                        <svg viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
                            <rect fill="none" height="256" width="256" />
                            <line fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="16" x1="216" x2="40" y1="56" y2="56" />
                            <line fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="16" x1="104" x2="104" y1="104" y2="168" />
                            <line fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="16" x1="152" x2="152" y1="104" y2="168" />
                            <path d="M200,56V208a8,8,0,0,1-8,8H64a8,8,0,0,1-8-8V56" fill="none" stroke="currentColor"
                                stroke-linecap="round" stroke-linejoin="round" stroke-width="16" />
                            <path d="M168,56V40a16,16,0,0,0-16-16H104A16,16,0,0,0,88,40V56" fill="none"
                                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="16" />
                        </svg>
                    </button>
                </div>
            </div>


        </main>
    </div>
    <div th:replace="fragment/navbar :: bottombar('admin')"></div>
    <dialog id="galleryModal" class="modal">
        <div class="modal-box max-w-5xl p-6 bg-base-100 rounded-3xl shadow-xl">
            <h3 class="font-extrabold text-xl md:text-2xl text-neutral-800 mb-6">Pilih Gambar untuk Gallery</h3>

            <!-- Grid gambar -->
            <div id="nonGalleryContainer" class="columns-2 sm:columns-3 md:columns-4 gap-5 space-y-5 min-h-[200px]">
                <p id="loadingText" class="text-center text-neutral-400">Memuat gambar...</p>
            </div>

            <div class="modal-action flex justify-between items-center mt-6">
                <button class="btn btn-outline btn-error hover:scale-105 transition-transform duration-200"
                    id="closeModalBtn">
                    Batal
                </button>
                <button class="btn btn-primary hover:scale-105 transition-transform duration-200" id="saveGalleryBtn">
                    Simpan
                </button>
            </div>
        </div>
    </dialog>

    <dialog id="deleteModal" class="modal">
        <form method="dialog" class="modal-box max-w-md p-6 bg-base-100 rounded-3xl shadow-xl">
            <h3 class="font-extrabold text-lg md:text-xl text-neutral-800 mb-4">Hilangkan gambar dari gallery?</h3>

            <img id="deletePreviewImg" src="" alt="Preview Image"
                class="w-full h-48 object-cover rounded-xl mb-5 shadow-md">

            <div class="modal-action justify-between mt-4">
                <button type="button" class="btn btn-ghost text-neutral-600 hover:text-neutral-800 transition"
                    id="cancelDeleteBtn">
                    Batal
                </button>
                <button type="button" class="btn btn-error hover:scale-105 transition-transform duration-200"
                    id="confirmDeleteBtn">
                    Hapus
                </button>
            </div>
        </form>
    </dialog>



    <script th:src="@{/js/adminGallery.js}"></script>
</body>

</html>